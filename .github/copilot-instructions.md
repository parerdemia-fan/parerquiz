````instructions
# パレデミア学園クイズゲーム開発ガイドライン

## パレデミア学園について

### パレデミア学園基本情報

- 合計 60 名のアイドルが所属する学園型プロジェクト
- それぞれが夢を抱いて活動する世界観
- 「時計台ステージ」という選ばれし者だけが到達できる特別な場所がある
- 公式サイト: https://www.parerdemia.jp/
- 公式X: https://x.com/parerdemia

### 4 つの寮

パレデミア学園には 4 つの寮があり、各寮に 15 名ずつ所属しています：

1. **バゥ寮**
   - 寮の略記号: wa
   - 特徴: 『歌って踊れる正統派アイドル』をテーマに創立された寮。幼い頃に憧れたアイドルを夢見て頑張る女の子が多く集まっている。
   - 寮のエンブレム画像: assets/images/dormitory/wa.png
   - 寮のイメージカラー: 赤
2. **ミュゥ寮**
   - 寮の略記号: me
   - 特徴: 『ゴージャス・ガールズパワー』をテーマに創立された寮。ウチら最高ギャルマインドを持つ女の子が多く集まっている。
   - 寮のエンブレム画像: assets/images/dormitory/me.png
   - 寮のイメージカラー: ピンク
3. **クゥ寮**
   - 寮の略記号: co
   - 特徴: 『キュートなサイバーパンク』をテーマに創立された寮。ゲームが好きな美技巧者なゲーミング女子が多く集まっている。
   - 寮のエンブレム画像: assets/images/dormitory/co.png
   - 寮のイメージカラー: 水色
4. **ウィニー寮**
   - 寮の略記号: wh
   - 特徴: 『ウェスタンゴシック』をテーマに創立された寮。心に強さを秘めた麗しい女性が多く集まっている。
   - 寮のエンブレム画像: assets/images/dormitory/wh.png
   - 寮のイメージカラー: 緑

## ゲームの画面

## 画面構成とフロー

- タイトル画面
  - タイトル画面には以下の要素が表示される
    - ゲームタイトル 「パレクイズ～めざせ！パレデミア学園 60 名完全マスター！～」
    - 出題範囲
      - バゥ寮、ミュゥ寮、クゥ寮、ウィニー寮、すべて
    - ゲームモード
      - 名前当てモード
      - 顔当てモード
    - 難易度
      - ふつう
      - むずかしい(同じ髪色・似た髪色の人が優先的に選択肢に出るモード)
      - 寮生専用(シルエット表示モード)
    - スタートボタン
    - 取得したバッジを表示する場所
    - このゲームは二次創作物であり非公式のものであることを示す文言
  - スタートボタンを押すと、ゲーム画面に遷移する。
  - **設定の自動保存**: 出題範囲、ゲームモード、難易度の選択は LocalStorage に自動保存され、次回アクセス時に復元される
- ゲーム画面
  - ゲーム画面には以下の要素が表示される
    - 問題表示エリア
    - 回答選択肢エリア
  - 出題範囲のタレントがシャッフルされ、1 人ずつ問題が出題される
  - 回答すると以下のような表示になる
    - 正解なら正解の選択肢が正解表示になる
    - 不正解なら不正解の選択肢が不正解表示になり、正解の選択肢が正解とわかる表示になる
  - 回答後は自動的に次の問題に進む
    - 正解した場合: 1.5 秒後に次の問題へ自動進行
    - 不正解した場合: 3 秒後に次の問題へ自動進行
  - 全問出題後にゲーム終了となり、ゲーム終了画面に遷移する
- ゲーム終了画面
  - ゲーム終了画面には以下の要素が表示される
    - ゲームタイトル（他の画面と一貫性を保った位置）
    - 正解数
    - 不正解数
    - 正解率（大きく表示）
    - 結果に応じた称号とメッセージ
      - 100%: "🏆 パーフェクト！ 🏆" + 特別なアニメーション演出
      - 90%以上: "🌟 エクセレント！"
      - 70%以上: "✨ グレート！"
      - 50%以上: "👍 グッド！"
      - 50%未満: "📚 ファイト！"
    - リトライボタン(同じ条件で再度プレイ開始)
    - タイトルに戻るボタン
    - 全問正解時は特別な背景とお祝いアニメーション効果
    - **出題範囲表示**: 各寮のイメージカラーに対応した背景色と文字色で表示
      - バゥ寮: 赤色グラデーション背景
      - ミュゥ寮: ピンク色グラデーション背景
      - クゥ寮: 水色グラデーション背景
      - ウィニー寮: 緑色グラデーション背景
      - すべて: 虹色グラデーション背景（特別演出付き）

## バッジシステム

**バッジ取得システムの仕様:**

- **バッジの種類**: 出題範囲と難易度の組み合わせによる合計 15 種類のバッジ

  - 出題範囲: バゥ寮、ミュゥ寮、クゥ寮、ウィニー寮、すべて (5 種類)
  - 難易度: ふつう（銅色）、むずかしい（銀色）、寮生専用（金色） (3 種類)

- **取得条件**: 各条件で全問正解（100%正解率）を達成した場合にバッジを取得

- **バッジのアップグレード機能**:

  - 同じ出題範囲で上位難易度のバッジを取得した場合、下位のバッジと差し替え
  - 上位バッジ保持時は下位バッジの取得条件を満たしても取得不可
  - プレイヤーは最大 5 個のバッジを保持（各出題範囲につき 1 個）

- **バッジのデザイン**:

  - 基本形状: 装飾付きの円形
  - 縁取り色: 銅色（ふつう）、銀色（むずかしい）、金色（寮生専用）
  - 中央画像: 各寮のエンブレム（寮別）、パレデミア学園ロゴ（すべて）

- **保存機能**:

  - LocalStorage に保存（キー: `parerquiz-badges`）
  - アプリケーション起動時に自動復元

- **表示機能**:
  - タイトル画面にバッジコレクション表示エリアを追加
  - 取得済みバッジは実際の色とエンブレムで表示
  - 未取得バッジはグレーアウト表示

## Xシェア機能

**シズル感のあるシェア機能:**

- **タイトル画面シェア**: ゲームの魅力を最大限にアピールする絵文字とキャッチフレーズを含む（140文字以内）
- **結果シェア**: プレイ結果に応じた達成感や挑戦意欲を刺激する表現を使用（140文字以内）
- **共通要素**: 
  - 豊富な絵文字使用で視覚的魅力を向上
  - ハッシュタグは必要最小限に厳選（#パレデミア学園 #パレクイズ等）
  - ユーザーの挑戦意欲を刺激する文言
  - 結果の価値を高める表現（パーフェクト、エクセレント等）
  - X（旧Twitter）の文字数制限140文字以内に収める

## LocalStorage 設定保存機能

**設定の自動保存・復元機能:**

- **保存対象の設定**:

  - 出題範囲（寮の選択）
  - ゲームモード（名前当て/顔当て）
  - 難易度（ふつう/むずかしい/寮生専用）

- **保存タイミング**: ユーザーが設定を変更した瞬間に自動保存

- **復元タイミング**: アプリケーション起動時に自動復元

- **LocalStorage キー名**:

  - `parerquiz-selected-dormitory`: 選択された寮
  - `parerquiz-selected-game-mode`: 選択されたゲームモード
  - `parerquiz-selected-difficulty`: 選択された難易度

- **デフォルト値**: LocalStorage に保存されていない場合のデフォルト値

  - 出題範囲: 'すべて'
  - ゲームモード: 'name'（名前当てモード）
  - 難易度: 'ふつう'

- **実装詳細**:
  - React hooks の`useState`初期値で LocalStorage から復元
  - `useEffect`で設定変更を監視して自動保存
  - LocalStorage アクセス時のエラーハンドリングは基本的なブラウザ対応のみ

## 技術的特徴

- React + TypeScript + Vite + Tailwind CSS
- スクロールなしの 1 画面で完結する。画面幅・高さに対する割合でコンポーネントサイズを決める。画面が縦長なら縦用レイアウトにする。
- Github Pages で公開する

## アセット

- assets/data/talents.json : タレントの情報を格納した JSON ファイル
- assets/images/dormitory/{dormitory-code}.webp : 各寮のエンブレム画像
- assets/images/dormitory/{dormitory-code}_wp.webp : 各寮のウォールペーパー画像
- assets/images/face : タレントの顔画像(png)
- assets/images/ogp : タレントの OGP 画像(png)
- assets/images/ogp.png : このゲームの OGP 画像
- assets/images/portrait : タレントのポートレート画像(webp)
- assets/images/stand : タレントの立ち絵(png)
- assets/images/mirror.png : パレデミア学園の魔法の鏡の画像（favicon、出題範囲「すべて」、バッジコレクション「すべて」で使用）
- assets/images/parerdemia-logo.png : パレデミア学園のロゴ画像
- assets/images/clocktower.webp : 時計台の画像
- assets/images/parerdemia_bg.jpeg : 公式Xのヘッダー画像

※各タレントの画像のファイル名はタレントの学籍番号(studentId)になっている
※各寮の画像のファイル名は各寮の略記号になっている

## UI コンポーネント

- 回答選択肢コンポーネント

  - 名前当てモードのときは、回答前にはタレント名を表示し、タレント画像は表示しない
  - 顔当てモードのときは、回答前にはタレント画像(ポートレート)を表示し、タレント名は表示しない
    - タレントのポートレート画像は正方形である。それを考慮してレイアウトすること
  - 寮生専用モードでは、顔当てモードで回答前の選択肢画像がシルエット表示になる
  - 回答後はタレント画像(ポートレート)とタレント名の帯(背景は半透明で画像の下端に重ねて表示)を表示
  - 回答後は以下のパターンで表示が分かれ、それぞれタレント画像の背景色や帯の色などが異なる
    - 選択された正答
    - 選択された誤答
    - 選択されなかった正答
    - 選択されなかった誤答
  - 回答前と回答後でコンポーネントの幅と高さを変えてはならない。

- 出題コンポーネント
  - 問題が表示されるコンポーネント
    - 名前当てモードの場合はタレント画像(OGP 画像)を表示し、その下に趣味、特技、好きなもの、その他(誕生日・身長)を表示
      - 寮生専用モードでは、タレント画像がポートレート画像のシルエット表示になる
    - 顔当てモードの場合はタレント名(背景にシルエット絵文字)、将来の夢、趣味、特技、好きなもの、その他(誕生日・身長)を表示

## 寮生専用モード（シルエット表示）

寮生専用モードは高難易度モードで、以下の特徴があります：

- **名前当てモード**: 出題エリアのタレント画像がシルエット表示になる（OGP 画像の代わりにポートレート画像のシルエット）
- **顔当てモード**: 回答選択肢のタレント画像がシルエット表示になる（回答前のみ）
- **シルエット表示**: CSS フィルターを使用してポートレート画像を単色のシルエットに変換
  - `filter: brightness(0) contrast(1) sepia(1) saturate(0) hue-rotate(0deg)`
  - 透過部分と非透過部分が別々の単色で表示される

## ⚠️ 重要：開発ガイドライン ⚠️

**以下の開発ガイドラインは全ての開発作業において最優先で守るべき規則です。開発の一貫性と品質を維持するために、必ず全ての項目を確認し遵守してください。**

- **コードベースコンテキスト**：パレデミア学園メモリーゲームのコードベース全体は常に参照された状態であると仮定します。毎回のやり取りで明示的に指定しなくても、以前の会話で参照したファイルやコード構造は継続的に参照可能な状態です。
- モバイル表示に対する指示の場合、変更が PC 表示に影響を与えてはならない。
- PC 表示に対する指示の場合、変更がモバイル表示に影響を与えてはならない。
- 特に指示がなければ PC 表示とモバイル表示の両方に反映すること。
- 特定のゲームモードに対する指示の場合、他のゲームモードに影響を与えてはならない。
- 特定のコンポーネントに対する指示の場合、他のコンポーネントに影響を与えてはならない。
- スタイルに対する指示の場合、機能の動作に影響を与えてはならない。
- 特に指示がない限り assets の中は変更しないこと。
- 機能追加や仕様変更があった場合、必要に応じて copilot-instructions.md と README.md を更新すること。
- その他なにか記載するべき事象があれば、必要に応じて copilot-instructions.md と README.md を更新すること。
- 指示した部分以外のところを勝手に変更しないこと。

## CSS・Tailwind CSS 設定ガイドライン

**Tailwind CSS v4 系を使用しているため、以下の設定を維持すること：**

- **PostCSS 設定**: postcss.config.js では`@tailwindcss/postcss`プラグインを使用する
- **Tailwind 設定**: tailwind.config.js は ES Module 形式で記述する
- **CSS import**: src/index.css の最初の行は`@import 'tailwindcss';`を維持する
- **パッケージ管理**: package.json に含まれる Tailwind CSS 関連の依存関係は変更しない
  - `tailwindcss`: v4 系
  - `@tailwindcss/postcss`: v4 系
  - `postcss`: v8 系
  - `autoprefixer`: v10 系

**これらの設定を変更する場合は、必ず事前に確認すること。勝手に変更してはならない。**

**コードの変更を提案する前に、必ず上記のガイドラインに照らし合わせて内容を確認してください。ガイドラインに沿わない変更は認められません。特に、コメントガイドラインは必ず遵守してください。**

## TypeScript コーディングガイドライン

**TypeScript の型インポートに関する重要なルール：**

- **型のみの使用**: 型としてのみ使用される場合は必ず`import type`構文を使用すること
- **値としての使用**: 値として使用される場合は通常の`import`構文を使用すること
- **混合使用**: 同じモジュールから型と値の両方をインポートする場合は分けて記述すること

```typescript
// 正しい例
import type { Talent, GameMode } from "../types";
import { useState, useEffect } from "react";

// 間違った例
import { Talent, GameMode } from "../types"; // 型のみ使用なのにimport typeを使用していない
```

**verbatimModuleSyntax 対応**: プロジェクトで`verbatimModuleSyntax`が有効になっているため、型の不適切なインポートはコンパイルエラーとなります。必ず適切な構文を使用してください。

# このゲームの URL(GitHub Pages での公開 URL)

https://parerdemia-fan.github.io/parerquiz/
````
